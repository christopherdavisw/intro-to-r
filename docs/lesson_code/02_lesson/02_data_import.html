<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to R -</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<link href="../../lesson_code/02_lesson/03_exercise_3.html" rel="next">
<link href="../../lesson_code/02_lesson/01_welcome.html" rel="prev">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/my_logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Introduction to R</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Class Readme</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-lessons" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Lessons</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-lessons">    
        <li>
    <a class="dropdown-item" href="../../lesson_code/01_lesson/01_welcome.html" rel="" target="">
 <span class="dropdown-text">Lesson 1 - Data Wrangling</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../lesson_code/02_lesson/01_welcome.html" rel="" target="">
 <span class="dropdown-text">Lesson 2 - Data Wrangling 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../lesson_code/03_lesson/01_welcome.html" rel="" target="">
 <span class="dropdown-text">Lesson 3 - Data Visualization 1</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../lesson_code/functions.html" rel="" target="">
 <span class="menu-text">Functions</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../lesson_code/02_lesson/02_data_import.html">Data Import and Export</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lesson_code/02_lesson/01_welcome.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome Back</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lesson_code/02_lesson/02_data_import.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Data Import and Export</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lesson_code/02_lesson/03_exercise_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 3</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lesson_code/02_lesson/04_conditions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vectorized Conditions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lesson_code/02_lesson/05_stringr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Working With Strings</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lesson_code/02_lesson/06_exercise_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 4</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lesson_code/02_lesson/07_attributes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Attributes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lesson_code/02_lesson/08_reshaping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reshaping Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lesson_code/02_lesson/09_exercise_5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 5</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lesson_code/02_lesson/10_joining.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Combining Data Frames</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lesson_code/02_lesson/11_exercise_6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 6</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<p><img src="images/my_logo.png" class="img-fluid"></p>
</div></div>
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#data-import-and-export" id="toc-data-import-and-export" class="nav-link active" data-scroll-target="#data-import-and-export">Data Import and Export</a>
  <ul class="collapse">
  <li><a href="#packages" id="toc-packages" class="nav-link" data-scroll-target="#packages">Packages</a></li>
  <li><a href="#reading-in-data" id="toc-reading-in-data" class="nav-link" data-scroll-target="#reading-in-data">Reading in data</a>
  <ul class="collapse">
  <li><a href="#r-paths" id="toc-r-paths" class="nav-link" data-scroll-target="#r-paths">R paths</a></li>
  <li><a href="#reading-.csv-files" id="toc-reading-.csv-files" class="nav-link" data-scroll-target="#reading-.csv-files">Reading <code>.csv</code> files</a></li>
  <li><a href="#reading-excel-files" id="toc-reading-excel-files" class="nav-link" data-scroll-target="#reading-excel-files">Reading Excel Files</a></li>
  <li><a href="#native-.rds-files" id="toc-native-.rds-files" class="nav-link" data-scroll-target="#native-.rds-files">Native <code>.RDS</code> files</a></li>
  <li><a href="#arrow-.feather-and-.parquet" id="toc-arrow-.feather-and-.parquet" class="nav-link" data-scroll-target="#arrow-.feather-and-.parquet">Arrow: <code>.feather</code> and <code>.parquet</code></a></li>
  </ul></li>
  <li><a href="#writing-out-data" id="toc-writing-out-data" class="nav-link" data-scroll-target="#writing-out-data">Writing out data</a></li>
  <li><a href="#the-janitorclean_names-function" id="toc-the-janitorclean_names-function" class="nav-link" data-scroll-target="#the-janitorclean_names-function">The <code>janitor::clean_names()</code> function</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><center>
Developed by Christopher Davis
</center>



<section id="data-import-and-export" class="level1">
<h1>Data Import and Export</h1>
<p>Thus far we have only worked with built-in data frames like <code>starwars</code>. To be truly useful, we need to be able to read in stored data. We also need to be able to save out our data frames for later use.</p>
<section id="packages" class="level2">
<h2 class="anchored" data-anchor-id="packages">Packages</h2>
<p>In this section, we will be using:</p>
<ul>
<li><code>readr</code>: part of <code>tidyverse</code>, for plain text files (<code>.csv</code>)<br>
</li>
<li><code>data.table</code>: for large <code>.csv</code> files</li>
<li><code>haven</code>: for SAS (<code>.sas7bdat</code>, <code>.sas7bcat</code>) and Stata (<code>.dta</code>) files<br>
</li>
<li><code>arrow</code>: for <code>.feather</code> and <code>.parquet</code> files.</li>
</ul>
<p><br></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Remember if you do not have these packages installed, call <code>install.packages("&lt;package_name&gt;")</code> in the console. Load them in scripts or the console with <code>library(&lt;package_name&gt;)</code>.</p>
</div>
</div>
<p><br></p>
</section>
<section id="reading-in-data" class="level2">
<h2 class="anchored" data-anchor-id="reading-in-data">Reading in data</h2>
<p>In general, many of the functions used to read in data in R will have the <code>read</code> prefix.</p>
<ul>
<li><code>read::read_csv()</code>: read in <code>.csv</code> files</li>
<li><code>readxl::read_excel()</code>: read in <code>.xlsx</code> or <code>.xls</code> files</li>
<li><code>haven::read_sas()</code> read in <code>.sas7bdat</code> or <code>.sas7bcat</code> files</li>
<li><code>haven::read_stata()</code>: read in <code>.dta</code> files</li>
<li><code>readRDS()</code>: read in native <code>.RDS</code> files</li>
<li><code>arrow::read_feather()</code>: read in <code>.feather</code> files</li>
<li><code>arrow::read_parquet()</code>: read in <code>.parquet</code> files</li>
</ul>
<p>The <code>data.table::fread()</code> function is also available for readin gin large <code>.csv</code> files relatively fast.</p>
<p><br></p>
<section id="r-paths" class="level3">
<h3 class="anchored" data-anchor-id="r-paths">R paths</h3>
<p>There are a few things you should know about paths in R.</p>
<ul>
<li>With R paths, you must use <code>/</code> slashes to indicate folders within a path, not <code>\</code>.</li>
<li>You can reference up a directory using relative file paths with <code>../</code>.</li>
<li>You can change your current directory with the <code>setwd("&lt;path&gt;")</code> function. I recommend not to do this, as it makes it more difficult to collaborate with others. Use <code>getwd()</code> to see your current directory (or look at the top of the console).</li>
<li>Each of the <code>read_*</code> functions has arguments that can help read in the data. For example, some allow you to skip rows when reading in, only read in certain columns, set column types, and more.</li>
</ul>
<p><br></p>
</section>
<section id="reading-.csv-files" class="level3">
<h3 class="anchored" data-anchor-id="reading-.csv-files">Reading <code>.csv</code> files</h3>
<p>For the simplest use cases, the various read functions will need just one argument: the path to the file you want to load.</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>sepal <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/iris.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br> <br></p>
<p>I encourage the use of relative filepaths like this, but you could use the aboslute file path if you would like as well.</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>sepal <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"C:/Users/christopherdavis/intro-to-r/lesson_code/02_lesson/data/iris.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<p>We can now work with this data frame as we would any other.</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>sepal <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Species <span class="sc">==</span> <span class="st">"setosa"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<section id="reading-large-.csv-files" class="level4">
<h4 class="anchored" data-anchor-id="reading-large-.csv-files">Reading large <code>.csv</code> files</h4>
<p>One function that may help speed up reading in large <code>.csv</code> files is the <code>data.table::fread()</code> function. It uses C++ under the hood to optimize reading in the data.</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>sas_dat <span class="ot">&lt;-</span> <span class="fu">read_sas</span>(<span class="st">"Data/UADAggs_nat_V3_0.sas7bdat"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>stata_dat <span class="ot">&lt;-</span> <span class="fu">read_stata</span>(<span class="st">"data/UADAggs_nat_V3_0.dta"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<p>You can also read in <code>xpt</code> SAS transfer files.</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>xpt_dat <span class="ot">&lt;-</span> <span class="fu">read_xpt</span>(<span class="st">"data/UADAggs_nat_V3_0.xpt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
</section>
</section>
<section id="reading-excel-files" class="level3">
<h3 class="anchored" data-anchor-id="reading-excel-files">Reading Excel Files</h3>
<p>Reading in Excel files is a little more complicated because there are sometimes more than one sheet to work with.</p>
<p>To find out the excel sheets in a particular excel file, use the <code>readxl::excel_sheets()</code> function.</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>excel_path <span class="ot">&lt;-</span> <span class="st">"data/cars.xlsx"</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>my_sheets <span class="ot">&lt;-</span> <span class="fu">excel_sheets</span>(excel_path)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>my_sheets</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<p>We can then read in the data based on the excel sheet.</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_excel</span>(excel_path, </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">sheet =</span> my_sheets[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_excel</span>(excel_path, </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">sheet =</span> my_sheets[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
</section>
<section id="native-.rds-files" class="level3">
<h3 class="anchored" data-anchor-id="native-.rds-files">Native <code>.RDS</code> files</h3>
<p>We can read in native <code>.RDS</code> files with the <code>readRDS()</code> function.</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">readRDS</span>(<span class="st">"data/UADAggs_nat_V3_0.RDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<p><code>.RDS</code> files are files specific to R and are relatively small.</p>
<p><br></p>
</section>
<section id="arrow-.feather-and-.parquet" class="level3">
<h3 class="anchored" data-anchor-id="arrow-.feather-and-.parquet">Arrow: <code>.feather</code> and <code>.parquet</code></h3>
<p>Feather and Parquet formats are designed to be faster and more streamlined than other data formats, especially for big data (large data frames). Some estimates find them to take up at least 87 percent less space and be 34 times faster to read in as compared to <code>.csv</code> files. For reference, even <code>.csv</code> files are much faster to read into R than <code>.sas7bdat</code> files.</p>
<p>Tehse files achieve this with binary storge in columnar format as opposed to a row-based format. Each column holds values for a single attribute across all rows.</p>
<p><br></p>
<p><img src="images/parquet.png" class="img-fluid"></p>
<p><strong>Source:</strong><a href="https://learncsdesigns.medium.com/understanding-apache-parquet-d722645cfe74">Medium</a></p>
<p><br></p>
<p>Here’s the code to read in these files.</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_feather</span>(<span class="st">"data/UADAggs_nat_V3_0.feather"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">read_parquet</span>(<span class="st">"data/UADAggs_nat_V3_0.parquet"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<section id="feather-vs.-parquet" class="level4">
<h4 class="anchored" data-anchor-id="feather-vs.-parquet">Feather vs.&nbsp;Parquet</h4>
<ul>
<li><p>Both options are very fast, but Feather is faster.</p></li>
<li><p>Parquet is better for long-term storage and is smaller</p></li>
<li><p>Feather is much larger as it isn’t natively compressed (it is still 6 times smaller than its <code>.sas7bdat</code> equivalent). It is also likely to change its features more often, so is less stable. It is more suitable for short-term storage or intermediary datasets.</p></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>One of the only drawbacks of using these files is that because they are in binary format, the raw data version of these files cannot be easily read by humans. That’s okay, though, we can just read them in!</p>
</div>
</div>
<p><br></p>
</section>
</section>
</section>
<section id="writing-out-data" class="level2">
<h2 class="anchored" data-anchor-id="writing-out-data">Writing out data</h2>
<p>You can similarly write out data with the following functions.</p>
<ul>
<li><code>readr::write_csv()</code>: write out <code>.csv</code> files</li>
<li><code>haven::write_sas()</code>: write out <code>.sas7bdat</code> or <code>.sas7bcat</code> files</li>
<li><code>haven::write_dta()</code>: write_out <code>.dta</code> files</li>
<li><code>saveRDS()</code>: save native <code>.RDS</code> files</li>
<li><code>arrow::write_feather()</code>: write out <code>.feather</code> files</li>
<li><code>arrow::write_parquet()</code>: write out <code>.parquet</code> files</li>
</ul>
<p><br></p>
<p>Writing out excel sheets is a little more complicated; we can set up a mini tutorial for that if folks are interested.</p>
<p><br></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>These functions invisibly return the data frame, so you can add one of these <code>rite_*</code> functions at the end of a pipe if you’d like to assign a data frame while you are saving it out.</p>
</div>
</div>
<p><br></p>
</section>
<section id="the-janitorclean_names-function" class="level2">
<h2 class="anchored" data-anchor-id="the-janitorclean_names-function">The <code>janitor::clean_names()</code> function</h2>
<p>One of the most helpful functions to use after reading in data frames is the <code>clean_names()</code> function from the <code>janitor</code> package. Variables often are read in unstandardized and are a pain to clean up.</p>
<p>Names resulting from this function are unique and consist of only <code>_</code>, numbers, and letters.</p>
<p>They can be piped after reading in a data frame.</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_feather</span>(<span class="st">"data/UADAggs_nat_V3_0.feather"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../lesson_code/02_lesson/01_welcome.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Welcome Back</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../lesson_code/02_lesson/03_exercise_3.html" class="pagination-link">
        <span class="nav-page-text">Exercise 3</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">Contact christopherpouratdavis@gmail.com with any questions/concerns.</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>